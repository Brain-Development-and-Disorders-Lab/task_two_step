I want you to review the current state of the codebase. It’s not in a great state. It’s a codebase I tried to move from JavaScript to TypeScript. I don’t fully understand how it works, and I think it’s extremely overcomplicated.
I want you to completely rewrite it. This is a simple task. From the ground up. I want you to use the latest jsPsych version, and focus on clean, concise, simple, and maintainable TypeScript using best practices and a simple codebase structure.
I will describe to you the core specification below:
•	The original code is located in “old”. Only use this as a reference, not guidance of how to architect the code. Keep the experimental principles, such as the timeout when not selecting etc.
•	Use the same stimuli as before (rockets, aliens, rewards, planets, etc.). These are found under “old”. Please copy these files into the new codebase as necessary.
•	This is a two-step behavioral task paradigm, where participants will make two decisions to proceed them to two different states. The influence of probability is that the transitions may be “common” or “rare”.
•	The first stage of a single trial is brief (500ms) fixation cross display. The second stage is a choice between the rockets. The third stage is a choice between two aliens. A reward or no reward will then be displayed above the alien.
•	The background for the first and second stage is always earth. The background for the third stage is always color-matched to the aliens.
•	The two aliens are always the two that are of the same colors.
•	There will be a series of instructions screens (don’t populate the text for now, just leave some placeholder text) at the start of the experiment.
•	The controls will be “F” to select left and “J” to select right.
•	In the main trials, there is some counter-balancing of the rockets and aliens. Refer to the “old” code for direction on the exact probabilities. There is also a timeout for decisions.
•	Transition probability data is located in the CSV files under the “old/src/data” directory. “masterprob4” is for the main trials, “masterprobtut” is for the tutorial trials. I want you to move this into the source code rather than having to compile in CSV files.
•	Preserve the same data collection as before, with the same data points. Refer to “old” to see what is preserved.
•	Please use inbuilt jsPsych plugins where appropriate, especially for the instructions. Avoid using the SVG system of the old implementation. This is not responsive. This leads into the other goal of this being that it is responsive and maintainable.
•	Add comments only when necessary. Document functions concisely.
•	You will need to setup the TypeScript and build system boilerplate. I will need to have hot reload server for testing.
•	There is also the Gorilla platform integration, and this is handled via the “neurocog” package, which also needs to be included.
•	Don’t include the attention-check questions for now.
•	Initially, let’s setup a timeline that includes: 1 instructions screen (placeholder only), 4 rockets-to-aliens training trials (no counter-balancing), 4 aliens-to-reward training trials (no counter-balancing), 4 complete training trials (no counter-balancing), 1 instructions screen (placeholder only), 4 complete main trials (counter-balancing).

Before we get started, please review the “old” code and what my specification is. If there are any inconsistencies between the core experimental behavior of the “old” code, please let me know first and we will review. If you need any clarifications, please let me know too. Ask for my approval before continuing with the implementation once any issues are resolved in the specification.
